<% athletes = User.all.select{|x| x.role=="Athlete"}.sort{|x,y| x.name <=> y.name} %>
<nav class="top-bar" data-topbar role="navigation">
  <ul class="title-area">
    <li class="name">
      <h1><a href="/">Workout Log</a></h1>
    </li>
  </ul>

  <section class="top-bar-section">
    <% if logged_in? %>
      <ul>
        <li class="has-dropdown not-click">
          <a href="#">Categories</a>
          <ul class="dropdown">
            <li><%= link_to "Add Category", new_category_path %></li>
            <li class="divider"></li>
            <% Category.all.each do |cat| %>
              <li><%= link_to cat.name, category_path(cat)%></li>
            <% end %>
          </ul>
        </li>
      </ul>
      <ul class="right">
        <li class="has-dropdown not-click">
          <a href="#"><%= pluralize(athletes.size, "Athlete")%></a>
          <ul class="dropdown">
            <% athletes.each do |athlete| %>
              <li><%= link_to athlete.name, user_path(athlete)%></li>
            <% end %>
            <li class="divider"></li>
            <li><%= link_to "Add Athlete", new_user_path %></li>
          </ul>
        </li>
        <li>
          <%= link_to "Logout", logout_path %>
        </li>
      </ul>
    <% else %>

      <ul class="left">
        <li class="divider"></li>
        <li>
          <%= link_to "Register", register_path%>
        </li>
        <li class="divider"></li>
        <li>
          <%= link_to "Login", login_path %>
        </li>
      </ul>
    <% end %>
  </section>
</nav>